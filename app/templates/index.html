{% macro section(title, id=None) %}
<section id="id or title">
    <h2>{{ title }}</h2>
    <div class="grid-x grid-margin-x grid-margin-y">
        {{ caller() }}
    </div>
</section>
{% endmacro %}


{% macro card(name, size=6) %}
<div class="card cell medium-{{ size }}" style="background-color: {{ color() }}">
    {% include '/sections/' + name + '.html' %}
</div>
{% endmacro %}


{% macro deal_cards(cards) %}
{% for item in (cards | sort_cards) %}
    {% if item['group'] %}
        <div class="grid-y grid-margin-y cell medium-{{ item['group'][0][1] }}">
            {% for card_item in item['group'] %}
                {{ card(card_item[0]) }}
            {% endfor %}
        </div>
    {% else %}
        <div class="grid-y grid-margin-y cell medium-{{ item[1] }}">
            {{ card(item[0], size=12) }}
        </div>
    {% endif %}
{% endfor %}
{% endmacro %}


{% macro foreign_word(word, with_ipa=False, capitalize=False) %}
      <span class="word">{% if word.pos in ['LOC', 'NNP'] or capitalize%}{{ word | latin | capitalize }}{% else %}{{ word | latin }}{% endif %}</span>{%if with_ipa %}<span class="ipa"> ({{ word | ipa }})</span>{% endif %}{% endmacro %}

<!DOCTYPE html>
<html lang="en">
<head>
    <title>{{ city.name | latin | capitalize }} - Unfamiliar City</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link type="text/css" rel="stylesheet" href="static/css/foundation.min.css">
    <link type="text/css" rel="stylesheet" href="static/css/base.css">

    <link rel="shortcut icon" type="image/x-icon" href="/static/images/favicon.ico">

</head>
<body>

<header>
    <h1>Unfamiliar City</h1>
    <nav>
        <a href="/">New city</a>
        <a href="https://twitter.com/unfamiliar_city" target="_blank">Twitter</a>
        <a href="/">About</a>
    </nav>
</header>

<div class="container">

{% call section(id="title") %}
<div class="card cell medium-12" style="background-color: {{ color() }}">
    <h1>
        <small>Welcome to</small>
        {{ foreign_word(city.name) }}
    </h1>
    <p>{{ foreign_word(city.name) }} is a real neat ancient city, build on the
    bones of children sacrificed to the fanged god.</p>
</div>
{% endcall %}


{% call section('learn') %}
    {{ deal_cards(
        [['weather', 4], ['gender', 4], ['language', 6]]) }}
{% endcall %}

{% call section('sights') %}
    {{ deal_cards(
        [['fruit', 6], ['industry', 6], ['style', 6], ['religion', 6]]) }}
{% endcall %}

{% call section('dine') %}
    {{ deal_cards(
        [['fruit', 3], ['fruit', 3], ['fruit', 4], ['fruit', 5], ['fruit', 5]]) }}
{% endcall %}

</div>

<footer>
    <p>created by <a href="https://www.mousereeve.com" target="_blank">Mouse Reeve</a></p>
</footer>
</body>
</html>

